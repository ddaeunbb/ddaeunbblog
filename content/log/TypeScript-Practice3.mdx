---
title: íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì œëŒ€ë¡œ í†ºì•„ë³´ê¸° III
date: 2023-11-27
category: Log
tags:
  - typescript
  - axios
thumbnail: https://mir-s3-cdn-cf.behance.net/project_modules/1400_opt_1/05f4db179891059.65018019ebc4a.jpg
---

ì˜¤ëŠ˜ì€ axios ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ íƒ€ì…ì„ ì—´ì–´ë³´ê³  ì§ì ‘ êµ¬í˜„í•´ë³¼ê¹Œ í•©ë‹ˆë‹¤.ğŸ§
axios ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ë³´í†µ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•©ë‹ˆë‹¤.

```js
import axios from 'axios';

const getData = async () => {
  const response = await axios.get('https://jsonplaceholder.typicode.com/posts/1');
  return response;
}
```
ì´ë•Œ `axios`ëŠ” ë­˜ê¹Œìš”?

```ts
export interface AxiosStatic extends AxiosInstance {
  create(config?: CreateAxiosDefaults): AxiosInstance;
  Cancel: CancelStatic;
  CancelToken: CancelTokenStatic;
  Axios: typeof Axios;
  AxiosError: typeof AxiosError;
  HttpStatusCode: typeof HttpStatusCode;
  readonly VERSION: string;
  isCancel: typeof isCancel;
  all: typeof all;
  spread: typeof spread;
  isAxiosError: typeof isAxiosError;
  toFormData: typeof toFormData;
  formToJSON: typeof formToJSON;
  getAdapter: typeof getAdapter;
  CanceledError: typeof CanceledError;
  AxiosHeaders: typeof AxiosHeaders;
}

declare const axios: AxiosStatic;
```
`index.d.ts`ì—ì„œ `axios`ëŠ” `AxiosStatic`ì´ë¼ê³  ì— ë¹„ì–¸íŠ¸ ì„ ì–¸ì„ í•´ë‘ì—ˆëŠ”ë°ìš”, ì´ë•Œ `AxiosStactic`ì„ ë³´ë©´ `AxiosInstance`ë¥¼ ìƒì†í•˜ëŠ” ê°ì²´ë¡œ íƒ€ì…ì´ ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ë•Œ `AxiosInstanceë¥¼ ë”°ë¼ê°€ë³´ë©´` ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

```ts
export interface AxiosInstance extends Axios {
  <T = any, R = AxiosResponse<T>, D = any>(config: AxiosRequestConfig<D>): Promise<R>;
  <T = any, R = AxiosResponse<T>, D = any>(url: string, config?: AxiosRequestConfig<D>): Promise<R>;

  defaults: Omit<AxiosDefaults, 'headers'> & {
    headers: HeadersDefaults & {
      [key: string]: AxiosHeaderValue
    }
  };
}
```
`AxiosInstance`ëŠ” í•¨ìˆ˜ë¡œ ì •ì˜ë˜ì–´ìˆìŠµë‹ˆë‹¤. `AxiosInstance`ëŠ” ì•„ë˜ì™€ ê°™ì´ `axios`ë¥¼ ì‚¬ìš©í•  ë•Œì˜ íƒ€ì…ì„ ì •ì˜í•´ë‘ì—ˆë„¤ìš”.

```ts
axios('https://jsonplaceholder.typicode.com/posts/1', {
  method: 'GET',
  ...
})

axios({
  url: 'https://jsonplaceholder.typicode.com/posts/1',
  method: 'GET',
  ...
})
```

ê·¸ëŸ¼ `AxiosInstance`ê°€ ìƒì†í•˜ëŠ” `Axios`ëŠ” ë­˜ê¹Œìš”?

```ts
export class Axios {
  constructor(config?: AxiosRequestConfig);
  defaults: AxiosDefaults;
  interceptors: {
    request: AxiosInterceptorManager<InternalAxiosRequestConfig>;
    response: AxiosInterceptorManager<AxiosResponse>;
  };
  get<T = any, R = AxiosResponse<T>, D = any>(url: string, config?: AxiosRequestConfig<D>): Promise<R>;
  delete<T = any, R = AxiosResponse<T>, D = any>(url: string, config?: AxiosRequestConfig<D>): Promise<R>;
  head<T = any, R = AxiosResponse<T>, D = any>(url: string, config?: AxiosRequestConfig<D>): Promise<R>;
  options<T = any, R = AxiosResponse<T>, D = any>(url: string, config?: AxiosRequestConfig<D>): Promise<R>;
  post<T = any, R = AxiosResponse<T>, D = any>(url: string, data?: D, config?: AxiosRequestConfig<D>): Promise<R>;
  ...
}
```
`Axios` ëŠ” í´ë˜ìŠ¤ì˜€ë„¤ìš”! ê·¸ë˜ì„œ ì•„ë˜ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ axiosë¥¼ ì‚¬ìš©í•  ë•Œì˜ íƒ€ì…ì´ ì •ì˜ë˜ì–´ìˆìŠµë‹ˆë‹¤.

```ts
axios.get('https://jsonplaceholder.typicode.com/posts/1')
```
ë”°ë¼ì„œ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ axiosë¥¼ ì‚¬ìš©í•˜ë“ , ì•Œì•„ì„œ íƒ€ì…ì´ ë¶ˆëŸ¬ì™€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë¨¼ì € `get`ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ì œë„¤ë¦­ íƒ€ì…ì„ ì–´ë–»ê²Œ ë„£ëŠ”ê²Œ ë§ëŠ”ì§€ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.

---

## ğŸ“Œ get, post, ... ì‚¬ìš©í•´ë³´ê¸°
```ts
const getData = async () => {
  const response = await axios.get('https://jsonplaceholder.typicode.com/posts/1');
  return response;
}

// const response: AxiosResponse<any, any>
```
ìœ„ì™€ ê°™ì´ axiosë¡œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤ë©´, ì´ë•Œ `AxiosResponse`ëŠ” anyíƒ€ì…ìœ¼ë¡œ ì§€ì •ëœ ê²ƒì„ IDEì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts
export interface AxiosResponse<T = any, D = any> {
  data: T;
  status: number;
  statusText: string;
  headers: RawAxiosResponseHeaders | AxiosResponseHeaders;
  config: InternalAxiosRequestConfig<D>;
  request?: any;
}
```
`AxiosResponse`ì˜ ì œë„¤ë¦­ TëŠ” ë°ì´í„°ì˜ íƒ€ì…ì„ ì§€ì •í•˜ê²Œ ë˜ê³ , Dê°™ì€ ê²½ìš°ì—ëŠ” axios ì„¤ì • ê°ì²´ì˜ íƒ€ì…ì„ ì§€ì •í•˜ê²Œ ë©ë‹ˆë‹¤.
ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•œë‹¤ë©´, anyë¥¼ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts
interface MyData {
  userId: number;
  id: number;
  title: string;
  body: string;
}

// get<T = any, R = AxiosResponse<T>, D = any>(url: string, config?: AxiosRequestConfig<D>): Promise<R>;
const getData = async () => {
  const response = await axios.get<Data>('https://jsonplaceholder.typicode.com/posts/1');
  return response;
}
// const response: AxiosResponse<MyData, any>
```

ê·¸ëŸ¼ post ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ë„ ì—´ì–´ë³´ê² ìŠµë‹ˆë‹¤.

```ts
// post<T = any, R = AxiosResponse<T>, D = any>(url: string, data?: D, config?: AxiosRequestConfig<D>): Promise<R>;
const postData = async () => {
  const response = await axios.post('https://jsonplaceholder.typicode.com/posts/1', {
      title: 'foo',
      body: 'bar',
      userId: 1,
    });
  return response;
}
// const response: AxiosResponse<any, any>
```

ì´ë•Œ `post` íƒ€ì…ì„ ì—´ì–´ë³´ì•˜ì„ ë•Œ, `D`ì œë„¤ë¦­ì— í•„ìš”í•œ interfaceë„ í•„ìš”í•˜ë¯€ë¡œ ì±„ì›Œì¤ë‹ˆë‹¤.

```ts
interface PostResponse {}

interface MyPayload {
  title: string;
  body: string;
  userId: number;
}

const postData = async () => {
  const response = await axios.post<PostResponse, AxiosResponse<PostResponse>, MyPayload>('https://jsonplaceholder.typicode.com/posts/1', {
      title: 'foo',
      body: 'bar',
      userId: 1,
    });
  return response;
}
```
ì‘ë‹µì€ ì–´ë–»ê²Œ ì˜¬ì§€ ëª¨ë¥´ê¸°ë•Œë¬¸ì— ìœ„ì™€ ê°™ì´ ì„¤ì •í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.
ë§Œì•½ postë¥¼ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•œë‹¤ë©´ ì–´ë–¨ê¹Œìš”?

```ts
const postData2 = async () => {
  const response = await axios({
    url: 'https://jsonplaceholder.typicode.com/posts/1',
    method: 'post',
    data: {
      title: 'foo',
      body: 'bar',
      userId: 1,
    }
  });
  return response;
}

// <T = any, R = AxiosResponse<T>, D = any>(config: AxiosRequestConfig<D>): Promise<R>;
```
ì´ë•Œ íƒ€ì…ì€ `AxiosInstance`ì— ìˆëŠ” í•¨ìˆ˜ë¡œ íƒ€ì…ì´ ì§€ì •ë©ë‹ˆë‹¤.

---

## ğŸ“Œ axios ì—ëŸ¬ì²˜ë¦¬í•˜ê¸°

íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì—ì„œ `error` ê°ì²´ëŠ” `unknown` íƒ€ì…ìœ¼ë¡œ ì²˜ë¦¬ ë˜ê¸°ë•Œë¬¸ì— ì—ëŸ¬íƒ€ì…ì— ë”°ë¥¸ ë¶„ê¸°ì²˜ë¦¬ë¥¼ ì¶”í›„ì— ê¼­ í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.

```ts
(async () => {
  try {
    const response = await myAxios.get<Post, AxiosResponse<Post>>('https://jsonplaceholder.typicode.com/posts/1');
  }
  catch (error) {
    if(axios.isAxiosError(error)) { // ì»¤ìŠ¤í…€ íƒ€ì…ê°€ë“œ
      // { message: 'ì„œë²„ ì¥ì• ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.' }
      console.error((error.response as AxiosResponse<{ message: string}>)?.data.message);
    }
    const errorResponse = (error as AxiosError).response;
    console.log(errorResponse?.data);
  }
})()
```
ì‹¤ì œ `axios`ì—ì„œëŠ” `isAxiosError` ë©”ì„œë“œë¥¼ ì œê³µí•´ì£¼ê³  ìˆê¸° ë•Œë¬¸ì—, `instanceof` ì¸ì§€, ifë¬¸ ì²˜ë¦¬ë¥¼ í†µí•´ íƒ€ì…ê°€ë“œë¡œ ì¢í˜€ í™œìš©í•´ì„œ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.

ì´ì™¸ì—ë„ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ëŠ” ë°”ë³´ê°€ ë ë•Œê°€ ê°€ë” ìˆê¸° ë•Œë¬¸ì—, instanceofë¡œ íƒ€ì…ì„ ì¢í˜€ë„, ì—ëŸ¬ê°€ ìƒê¸¸ë•Œê°€ ìˆìŠµë‹ˆë‹¤.
íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì—ì„œì˜ ì¸í„°í˜ì´ìŠ¤ì™€ í´ë˜ìŠ¤ì˜ ì°¨ì´ëŠ”, ì»´íŒŒì¼ ê³¼ì •ì„ ê±°ì¹œí›„ js íŒŒì¼ì— ì½”ë“œê°€ ë‚¨ëƒ ì•ˆë‚¨ëŠëƒì˜ ì°¨ì´ê°€ ìˆê¸° ë•Œë¬¸ì¸ë°ìš”, 
ë”°ë¼ì„œ ì´ë•ŒëŠ” íƒ€ì… ë‹¨ì–¸ì„ í•´ì£¼ì–´ì•¼í•œë‹¤ê³  í•©ë‹ˆë‹¤!

ì•„ë˜ì—ì„œ ë” ìì„¸í•˜ê²Œ ì»¤ìŠ¤í…€ Error ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì„ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
[íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì»¤ìŠ¤í…€ Error ì²˜ë¦¬í•˜ê¸°](https://inpa.tistory.com/entry/TS-%F0%9F%93%98-%ED%83%80%EC%9E%85%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%BB%A4%EC%8A%A4%ED%85%80-Error-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0)
